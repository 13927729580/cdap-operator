apiVersion: cdap.cdap.io/v1alpha1
kind: CDAPMaster
metadata:
  labels:
    cdap.version: "6.0.0"
  name: master-1
spec:
  image: gcr.io/cloud-data-fusion-images/cloud-data-fusion:6.0.0-SNAPSHOT
  userInterfaceImage: gcr.io/cloud-data-fusion-images/cloud-data-fusion-ui:6.0.0-SNAPSHOT
  imagePullPolicy: Always
  # No need to list out all services. Only list the one that needs customizing
  messaging:
    metadata:
      labels:
        cdap.label: extra-label
    # Only support 1
    replicas: 1
    resources:
      limits:
        memory: "2Gi"
        cpu: "500m"
    storageSize: "100Gi"
    # nodeSelector:
    #   cloud.google.com/gke-accelerator: nvidia-tesla-k80
  appFabric:
    # Only support 1
    replicas: 1
  log:
    # Only support 1
    replicas: 1
  metadata:
    # Supports >= 1
    replicas: 2
  metrics:
    # Only support 1
    replicas: 1
  preview:
    # Only support 1
    replicas: 1
    resources:
      limits:
        memory: "2Gi"
        cpu: "1000m"
  userInterface:
    # Supports >= 1
    replicas: 1
  router:
    # Supports >= 1
    replicas: 1
  securitySecret: cdap-security
  locationURI: gs://somebucket
  config:
    enable.preview: "true"
    data.storage.implementation: postgresql
    data.storage.sql.jdbc.connection.url: jdbc:postgresql://google/cdap?socketFactory=com.google.cloud.sql.postgres.SocketFactory&cloudSqlInstance=cloud-data-fusion-builds:us-central1:cdap-demo
    data.storage.sql.jdbc.driver.name: org.postgresql.Driver
    metadata.storage.implementation: elastic
    security.store.system.properties.gcp-cloudkms.keyring.id: keystringId
